import { describe, it } from 'vitest';
import { createRenderer } from "../index.js";
import { ServerlessExecutionStatus, } from "../../../shared/types/http-requests.js";
describe('mock runServerlessFunction', () => {
    it('should provide the ability to spy on the runServerlessFunction function', async () => {
        const { mocks } = createRenderer('crm.record.tab');
        const { runServerlessFunction } = mocks;
        const serverlessExecutionResult = {
            status: ServerlessExecutionStatus.Success,
            response: {
                myFakeData: 'hello',
                anotherFakeData: 'bye',
            },
        };
        runServerlessFunction.nextResult(Promise.resolve(serverlessExecutionResult));
        const result = await runServerlessFunction({
            name: 'fake_function',
            parameters: {
                param1: 'value1',
            },
            propertiesToSend: ['prop1', 'prop2'],
        });
        expect(result).toEqual(serverlessExecutionResult);
        expect(runServerlessFunction.callCount).toBe(1);
        expect(runServerlessFunction.calls[0]).toEqual([
            {
                name: 'fake_function',
                parameters: {
                    param1: 'value1',
                },
                propertiesToSend: ['prop1', 'prop2'],
            },
        ]);
    });
});

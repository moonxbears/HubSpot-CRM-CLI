import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from "react/jsx-runtime";
import { describe, expect, it } from 'vitest';
import { Alert, Button, ButtonRow } from "../../../index.js";
import { createRenderer } from "../index.js";
import { ComponentMismatchedByTestIdError, FindInvalidComponentError, } from "../internal/errors.js";
describe('maybeFindByTestId()', () => {
    it('should return the element when found by testId', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(Button, { variant: "primary", testId: "my-button", children: "Click me" }) }));
        const button = maybeFindByTestId(Button, 'my-button');
        expect(button).toBeDefined();
        expect(button?.props).toMatchObject({
            variant: 'primary',
            testId: 'my-button',
        });
    });
    it('should return null when element with the given testId is not found', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(Button, { variant: "primary", testId: "my-button", children: "Click me" }) }));
        const button = maybeFindByTestId(Button, 'non-existent-testid');
        expect(button).toBeNull();
    });
    it('should throw ComponentMismatchedByTestIdError when testId exists but component type does not match', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(Button, { variant: "primary", testId: "my-button", children: "Click me" }) }));
        expect(() => maybeFindByTestId(Alert, 'my-button')).toThrow(ComponentMismatchedByTestIdError);
    });
    it('should throw FindInvalidComponentError when target component is invalid', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(Button, { variant: "primary", testId: "my-button", children: "Click me" }) }));
        const MyFakeComponent = () => { };
        expect(() => maybeFindByTestId(MyFakeComponent, 'my-button')).toThrow(FindInvalidComponentError);
    });
    it('should return null after re-rendering removes the component', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(Button, { variant: "primary", testId: "my-button", children: "Click me" }) }));
        let button = maybeFindByTestId(Button, 'my-button');
        expect(button).toBeDefined();
        render(_jsx(_Fragment, { children: _jsx(Alert, { title: "My Alert" }) }));
        button = maybeFindByTestId(Button, 'my-button');
        expect(button).toBeNull();
    });
    it('should handle multiple components with different testIds', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsxs(_Fragment, { children: [_jsx(Button, { variant: "primary", testId: "button-1", children: "Button 1" }), _jsx(Button, { variant: "secondary", testId: "button-2", children: "Button 2" }), _jsx(Button, { variant: "destructive", testId: "button-3", children: "Button 3" })] }));
        const button1 = maybeFindByTestId(Button, 'button-1');
        expect(button1?.props.variant).toEqual('primary');
        const button2 = maybeFindByTestId(Button, 'button-2');
        expect(button2?.props.variant).toEqual('secondary');
        const button3 = maybeFindByTestId(Button, 'button-3');
        expect(button3?.props.variant).toEqual('destructive');
        const button4 = maybeFindByTestId(Button, 'button-4');
        expect(button4).toBeNull();
    });
    it('should work with nested components', () => {
        const { render, maybeFindByTestId } = createRenderer('crm.record.tab');
        render(_jsx(_Fragment, { children: _jsx(ButtonRow, { children: _jsx(Button, { variant: "primary", testId: "nested-button", children: "Nested" }) }) }));
        const button = maybeFindByTestId(Button, 'nested-button');
        expect(button).toBeDefined();
        expect(button?.props).toMatchObject({
            variant: 'primary',
            testId: 'nested-button',
        });
    });
});
